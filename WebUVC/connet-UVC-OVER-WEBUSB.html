<h3>Simple WebUSB Example</h3>

<div id='results'>
  <div>
    <video autoplay></video>
    <button id='getUserMediaButton'>Connet to WebCam</button>
  </div>
  <div>
    <canvas id='grabFrameCanvas'></canvas>
    <button id='grabFrameButton'>Send test Commnad</button>
  </div>
  <!-- <div>
    <canvas id='takePhotoCanvas'></canvas>
    <button id='takePhotoButton'>Take Photo</button>
  </div> -->
</div>


<script>
document.addEventListener('DOMContentLoaded', async () => {
    let devices = await navigator.usb.getDevices();
    devices.forEach(device => {
      // Add |device| to the UI.
    });
  });

  navigator.usb.addEventListener('connect', event => {
    // Add |event.device| to the UI.
  });

  navigator.usb.addEventListener('disconnect', event => {
    // Remove |event.device| from the UI.
  });
</script>

<script>  // Connet to WebCam button
let button1 = document.querySelector('#getUserMediaButton');
button1.addEventListener('click', async () => {

  const opts = {
  filters: [
    // {
    // classCode: 16, // 0x10
    // subclassCode: 2, // 0x02
    // protocolCode: 0x00,
    // }
  ]
  }

  let device;
  try {
       device = await navigator.usb.requestDevice(opts)
       .then(usbDevice => {
        console.log("Product name: " + usbDevice.productName);
        })
        .catch(e => {
          console.log("There is no device. " + e);
        });
  } catch (err) {
    alert('Error: ' + err.message);
  }    
});
</script>

<script>    // Send test Commnad
let button2 = document.querySelector('#grabFrameButton');
button2.addEventListener('click', async () => {

  let device2;
  try {
      device2 = await navigator.usb.requestDevice(opts)
      .then(usbDevice => {
        console.log("Product name: " + usbDevice.productName);
      })
      .catch(e => {
        console.log("There is no device. " + e);
      });
  } catch (err) {
    alert('Error: ' + err.message);
  }
});
</script>


